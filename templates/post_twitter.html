{% extends 'base.html' %}
{% block content %}

<script src="https://rawgithub.com/wanasit/chrono/master/chrono.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.15.2/moment.min.js"></script>

<div class="container">

    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-6 col-md-offset-3 col-lg-12 col-lg-offset-3">
            <h1>Set it, and forget it!</h1>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-6 col-md-offset-3 col-lg-6 col-lg-offset-3">
            <h2>Let's post to your Twitter, {{username}}!</h2>
        </div>
    </div>

<br>
   <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-6 col-md-offset-3 col-lg-6 col-lg-offset-3">
            <form action='/confirm_profile' method="POST">
                <p>Write your witty/thoughtful/deep/hilarious profile post here:</p>
                <textarea id="userpost" class="form-control" rows="5" cols="54" name="userpost" required="true"></textarea>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-6 col-md-offset-3 col-lg-6 col-lg-offset-3">
            <p id="remaining_chars"></p>

        </div>
    </div>


    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-6 col-md-offset-3 col-lg-6 col-lg-offset-3">
            <p id="remaining_chars"></p>

        </div>
    </div>

                <script type="text/javascript">

                $(document).ready(function(){

                    $("#userpost").on('input', function() {
                        if ($(this).val().length>=140) {
                            alert('Oops! Remember- Facebook has a 63,206 character limit!');
                         }
                         
                    $('#remaining_chars').html("Remaining characters : " + (63206 - this.value.length))
 
                     });

                    function changedTime() {
                         // time_from_textbox is whatever they typed in
                        var time_from_textbox = $('#time_textbox').val();
                        console.log('time_from_textbox', time_from_textbox);

                        // Parsed chrono date (chrono.parseDate(x))
                        var chrono_time = chrono.parseDate(time_from_textbox);
                        console.log('chrono_time', chrono_time);

                        // format that to the value we want to actually send to facebook (seconds epoch value)
                        var moment_time = moment(chrono_time);
                        console.log('moment_time', moment_time);

                        var moment_unix = moment_time.format('X');

                        var timezone = moment_time.format('zz')

                        console.log(timezone)
                        console.log(moment_unix)


                        // setting our final time value (seconds since the epoch) to our hidden input
                        $('#hidden_time').val(moment_unix);
                        $('#time_example').html(chrono_time);

                    }
                    $('#time_textbox').on('input', changedTime);
                    var current_time = moment();

                    var hour_of_current_time = parseInt(current_time.format('H'));
                    console.log(hour_of_current_time);

                    if (hour_of_current_time < 8) {
                        $('#time_textbox').val("Today at 8am");
                    } else if ( hour_of_current_time>= 8 && hour_of_current_time < 17) {
                        $('#time_textbox').val("Today at 5pm");
                    } else if( hour_of_current_time >= 17 && hour_of_current_time < 22) {
                        $('#time_textbox').val("Today at 10pm");
                    } else {
                        $('#time_textbox').val("Tomorrow at 8am");
                    }

                    changedTime();

                });

        
            </script>
                <input id="hidden_time" type="hidden" name="publish_timestamp">
<!--                 <input id="hidden_time_textbox" type="hidden" name="word_time_format">
 -->                
<br>              
<img src='/static/latergator.jpg' height="300" width="400" onmouseover="this.src='/static/latergatorsuggests.jpg';" onmouseout="this.src='/static/latergator.jpg';" />
<br>
    <input id="time_textbox" name="time_to_show" rows="5" cols="100">
    <p>Is this the time you'd like to post at?</p>
    <p id="time_example"></p>

        <input type="submit" value="Set it, and forget it!">
    </form>

{% endblock %}